dedString */
function parse_XLUnicodeRichExtendedString(blob) {
    var cp = current_codepage;
    current_codepage = 1200;
    var cch = blob.read_shift(2), flags = blob.read_shift(1);
    var fHighByte = flags & 0x1, fExtSt = flags & 0x4, fRichSt = flags & 0x8;
    var width = 1 + (flags & 0x1); // 0x0 -> utf8, 0x1 -> dbcs
    var cRun, cbExtRst;
    var z = {};
    if(fRichSt) cRun = blob.read_shift(2);
    if(fExtSt) cbExtRst = blob.read_shift(4);
    var encoding = (flags & 0x1) ? 'dbcs-cont' : 'sbcs-cont';
    var msg = cch === 0 ? "" : blob.read_shift(cch, encoding);
    if(fRichSt) blob.l += 4 * cRun; //TODO: parse this
    if(fExtSt) blob.l += cbExtRst; //TODO: parse this
    z.t = msg;
    if(!fRichSt) { z.raw = "<t>" + z.t + "</t>"; z.r = z.t; }
    current_codepage = cp;
    return z;
}

/* 2.5.296 XLUnicodeStringNoCch */
function parse_XLUnicodeStringNoCch(blob, cch, opts) {
    var retval;
    var fHighByte = blob.read_shift(1);
    if(fHighByte===0) { retval = blob.read_shift(cch, 'sbcs-cont'); }
    else { retval = blob.read_shift(cch, 'dbcs-cont'); }
    return retval;
}

/* 2.5.294 XLUnicodeString */
function parse_XLUnicodeString(blob, length, opts) {
    var cch = blob.read_shift(opts !== undefined && opts.biff > 0 && opts.biff < 8 ? 1 : 2);
    if(cch === 0) { blob.l++; return ""; }
    return parse_XLUnicodeStringNoCch(blob, cch, opts);
}
/* BIFF5 override */
function parse_XLUnicodeString2(blob, length, opts) {
    if(opts.biff !== 5 && opts.biff !== 2) return parse_XLUnicodeString(blob, length, opts);
    var cch = blob.read_shift(1);
    if(cch === 0) { blob.l++; return ""; }
    return blob.read_shift(cch, 'sbcs-cont');
}

/* [MS-XLS] 2.5.61 ControlInfo */
var parse_ControlInfo = parsenoop;

/* [MS-OSHARED] 2.3.7.6 URLMoniker TODO: flags */
var parse_URLMoniker = function(blob, length) {
    var len = blob.read_shift(4), start = blob.l;
    var extra = false;
    if(len > 24) {
        /* look ahead */
        blob.l += len - 24;
        if(blob.read_shift(16) === "795881f43b1d7f48af2c825dc4852763") extra = true;
        blob.l = start;
    }
    var url = blob.read_shift((extra?len-24:len)>>1, 'utf16le').replace(chr0,"");
    if(extra) blob.l += 24;
    return url;
};

/* [MS-OSHARED] 2.3.7.8 FileMoniker TODO: all fields */
var parse_FileMoniker = function(blob, length) {
    var cAnti = blob.read_shift(2);
    var ansiLength = blob.read_shift(4);
    var ansiPath = blob.read_shift(ansiLength, 'cstr');
    var endServer = blob.read_shift(2);
    var versionNumber = blob.read_shift(2);
    var cbUnicodePathSize = blob.read_shift(4);
    if(cbUnicodePathSize === 0) return ansiPath.replace(/\\/g,"/");
    var cbUnicodePathBytes = blob.read_shift(4);
    var usKeyValue = blob.read_shift(2);
    var unicodePath = blob.read_shift(cbUnicodePathBytes>>1, 'utf16le').replace(chr0,"");
    return unicodePath;
};

/* [MS-OSHARED] 2.3.7.2 HyperlinkMoniker TODO: all the monikers */
var parse_HyperlinkMoniker = function(blob, length) {
    var clsid = blob.read_shift(16); length -= 16;
    switch(clsid) {
        case "e0c9ea79f9bace118c8200aa004ba90b": return parse_URLMoniker(blob, length);
        case "0303000000000000c000000000000046": return parse_FileMoniker(blob, length);
        default: throw "unsupported moniker " + clsid;
    }
};

/* [MS-OSHARED] 2.3.7.9 HyperlinkString */
var parse_HyperlinkString = function(blob, length) {
    var len = blob.read_shift(4);
    var o = blob.read_shift(len, 'utf16le').replace(chr0, "");
    return o;
};

/* [MS-OSHARED] 2.3.7.1 Hyperlink Object TODO: unify params with XLSX */
var parse_Hyperlink = function(blob, length) {
    var end = blob.l + length;
    var sVer = blob.read_shift(4);
    if(sVer !== 2) throw new Error("Unrecognized streamVersion: " + sVer);
    var flags = blob.read_shift(2);
    blob.l += 2;
    var displayName, targetFrameName, moniker, oleMoniker, location, guid, fileTime;
    if(flags & 0x0010) displayName = parse_HyperlinkString(blob, end - blob.l);
    if(flags & 0x0080) targetFrameName = parse_HyperlinkString(blob, end - blob.l);
    if((flags & 0x0101) === 0x0101) moniker = parse_HyperlinkString(blob, end - blob.l);
    if((flags & 0x0101) === 0x0001) oleMoniker = parse_HyperlinkMoniker(blob, end - blob.l);
    if(flags & 0x0008) location = parse_HyperlinkString(blob, end - blob.l);
    if(flags & 0x0020) guid = blob.read_shift(16);
    if(flags & 0x0040) fileTime = parse_FILETIME(blob, 8);
    blob.l = end;
    var target = (targetFrameName||moniker||oleMoniker);
    if(location) target+="#"+location;
    return {Target: target};
};

/* 2.5.178 LongRGBA */
function parse_LongRGBA(blob, length) { var r = blob.read_shift(1), g = blob.read_shift(1), b = blob.read_shift(1), a = blob.read_shift(1); return [r,g,b,a]; }

/* 2.5.177 LongRGB */
function parse_LongRGB(blob, length) { var x = parse_LongRGBA(blob, length); x[3] = 0; return x; }


/* --- MS-XLS --- */

/* 2.5.19 */
function parse_XLSCell(blob, length) {
    var rw = blob.read_shift(2); // 0-indexed
    var col = blob.read_shift(2);
    var ixfe = blob.read_shift(2);
    return {r:rw, c:col, ixfe:ixfe};
}

/* 2.5.134 */
function parse_frtHeader(blob) {
    var rt = blob.read_shift(2);
    var flags = blob.read_shift(2); // TODO: parse these flags
    blob.l += 8;
    return {type: rt, flags: flags};
}



function parse_OptXLUnicodeString(blob, length, opts) { return length === 0 ? "" : parse_XLUnicodeString2(blob, length, opts); }

/* 2.5.158 */
var HIDEOBJENUM = ['SHOWALL', 'SHOWPLACEHOLDER', 'HIDEALL'];
var parse_HideObjEnum = parseuint16;

/* 2.5.344 */
function parse_XTI(blob, length) {
    var iSupBook = blob.read_shift(2), itabFirst = blob.read_shift(2,'i'), itabLast = blob.read_shift(2,'i');
    return [iSupBook, itabFirst, itabLast];
}

/* 2.5.218 */
function parse_RkRec(blob, length) {
    var ixfe = blob.read_shift(2);
    var RK = parse_RkNumber(blob);
    //console.log("::", ixfe, RK,";;");
    return [ixfe, RK];
}

/* 2.5.1 */
function parse_AddinUdf(blob, length) {
    blob.l += 4; length -= 4;
    var l = blob.l + length;
    var udfName = parse_ShortXLUnicodeString(blob, length);
    var cb = blob.read_shift(2);
    l -= blob.l;
    if(cb !== l) throw "Malformed AddinUdf: padding = " + l + " != " + cb;
    blob.l += cb;
    return udfName;
}

/* 2.5.209 TODO: Check sizes */
function parse_Ref8U(blob, length) {
    var rwFirst = blob.read_shift(2);
    var rwLast = blob.read_shift(2);
    var colFirst = blob.read_shift(2);
    var colLast = blob.read_shift(2);
    return {s:{c:colFirst, r:rwFirst}, e:{c:colLast,r:rwLast}};
}

/* 2.5.211 */
function parse_RefU(blob, length) {
    var rwFirst = blob.read_shift(2);
    var rwLast = blob.read_shift(2);
    var colFirst = blob.read_shift(1);
    var colLast = blob.read_shift(1);
    return {s:{c:colFirst, r:rwFirst}, e:{c:colLast,r:rwLast}};
}

/* 2.5.207 */
var parse_Ref = parse_RefU;

/* 2.5.143 */
function parse_FtCmo(blob, length) {
    blob.l += 4;
    var ot = blob.read_shift(2);
    var id = blob.read_shift(2);
    var flags = blob.read_shift(2);
    blob.l+=12;
    return [id, ot, flags];
}

/* 2.5.149 */
function parse_FtNts(blob, length) {
    var out = {};
    blob.l += 4;
    blob.l += 16; // GUID TODO
    out.fSharedNote = blob.read_shift(2);
    blob.l += 4;
    return out;
}

/* 2.5.142 */
function parse_FtCf(blob, length) {
    var out = {};
    blob.l += 4;
    blob.cf = blob.read_shift(2);
    return out;
}

/* 2.5.140 - 2.5.154 and friends */
var FtTab = {
    0x15: parse_FtCmo,
    0x13: parsenoop,                                /* FtLbsData */
    0x12: function(blob, length) { blob.l += 12; }, /* FtCblsData */
    0x11: function(blob, length) { blob.l += 8; },  /* FtRboData */
    0x10: parsenoop,                                /* FtEdoData */
    0x0F: parsenoop,                                /* FtGboData */
    0x0D: parse_FtNts,                              /* FtNts */
    0x0C: function(blob, length) { blob.l += 24; }, /* FtSbs */
    0x0B: function(blob, length) { blob.l += 10; }, /* FtRbo */
    0x0A: function(blob, length) { blob.l += 16; }, /* FtCbls */
    0x09: parsenoop,                                /* FtPictFmla */
    0x08: function(blob, length) { blob.l += 6; },  /* FtPioGrbit */
    0x07: parse_FtCf,                               /* FtCf */
    0x06: function(blob, length) { blob.l += 6; },  /* FtGmo */
    0x04: parsenoop,                                /* FtMacro */
    0x00: function(blob, length) { blob.l += 4; }   /* FtEnding */
};
function parse_FtArray(blob, length, ot) {
    var s = blob.l;
    var fts = [];
    while(blob.l < s + length) {
        var ft = blob.read_shift(2);
        blob.l-=2;
        try {
            fts.push(FtTab[ft](blob, s + length - blob.l));
        } catch(e) { blob.l = s + length; return fts; }
    }
    if(blob.l != s + length) blob.l = s + length; //throw "bad Object Ft-sequence";
    return fts;
}

/* 2.5.129 */
var parse_FontIndex = parseuint16;

/* --- 2.4 Records --- */

/* 2.4.21 */
function parse_BOF(blob, length) {
    var o = {};
    o.BIFFVer = blob.read_shift(2); length -= 2;
    switch(o.BIFFVer) {
        case 0x0600: /* BIFF8 */
        case 0x0500: /* BIFF5 */
        case 0x0002: case 0x0007: /* BIFF2 */
            break;
        default: throw "Unexpected BIFF Ver " + o.BIFFVer;
    }
    blob.read_shift(length);
    return o;
}


/* 2.4.146 */
function parse_InterfaceHdr(blob, length) {
    if(length === 0) return 0x04b0;
    var q;
    if((q=blob.read_shift(2))!==0x04b0) throw 'InterfaceHdr codePage ' + q;
    return 0x04b0;
}


/* 2.4.349 */
function parse_WriteAccess(blob, length, opts) {
    if(opts.enc) { blob.l += length; return ""; }
    var l = blob.l;
    // TODO: make sure XLUnicodeString doesnt overrun
    var UserName = parse_XLUnicodeString(blob, 0, opts);
    blob.read_shift(length + l - blob.l);
    return UserName;
}

/* 2.4.28 */
function parse_BoundSheet8(blob, length, opts) {
    var pos = blob.read_shift(4);
    var hidden = blob.read_shift(1) >> 6;
    var dt = blob.read_shift(1);
    switch(dt) {
        case 0: dt = 'Worksheet'; break;
        case 1: dt = 'Macrosheet'; break;
        case 2: dt = 'Chartsheet'; break;
        case 6: dt = 'VBAModule'; break;
    }
    var name = parse_ShortXLUnicodeString(blob, 0, opts);
    if(name.length === 0) name = "Sheet1";
    return { pos:pos, hs:hidden, dt:dt, name:name };
}

/* 2.4.265 TODO */
function parse_SST(blob, length) {
    var cnt = blob.read_shift(4);
    var ucnt = blob.read_shift(4);
    var strs = [];
    for(var i = 0; i != ucnt; ++i) {
        strs.push(parse_XLUnicodeRichExtendedString(blob));
    }
    strs.Count = cnt; strs.Unique = ucnt;
    return strs;
}

/* 2.4.107 */
function parse_ExtSST(blob, length) {
    var extsst = {};
    extsst.dsst = blob.read_shift(2);
    blob.l += length-2;
    return extsst;
}


/* 2.4.221 TODO*/
function parse_Row(blob, length) {
    var rw = blob.read_shift(2), col = blob.read_shift(2), Col = blob.read_shift(2), rht = blob.read_shift(2);
    blob.read_shift(4); // reserved(2), unused(2)
    var flags = blob.read_shift(1); // various flags
    blob.read_shift(1); // reserved
    blob.read_shift(2); //ixfe, other flags
    return {r:rw, c:col, cnt:Col-col};
}


/* 2.4.125 */
function parse_ForceFullCalculation(blob, length) {
    var header = parse_frtHeader(blob);
    if(header.type != 0x08A3) throw "Invalid Future Record " + header.type;
    var fullcalc = blob.read_shift(4);
    return fullcalc !== 0x0;
}


var parse_CompressPictures = parsenoop2; /* 2.4.55 Not interesting */



/* 2.4.215 rt */
function parse_RecalcId(blob, length) {
    blob.read_shift(2);
    return blob.read_shift(4);
}

/* 2.4.87 */
function parse_DefaultRowHeight (blob, length) {
    var f = blob.read_shift(2), miyRw;
    miyRw = blob.read_shift(2); // flags & 0x02 -> hidden, else empty
    var fl = {Unsynced:f&1,DyZero:(f&2)>>1,ExAsc:(f&4)>>2,ExDsc:(f&8)>>3};
    return [fl, miyRw];
}

/* 2.4.345 TODO */
function parse_Window1(blob, length) {
    var xWn = blob.read_shift(2), yWn = blob.read_shift(2), dxWn = blob.read_shift(2), dyWn = blob.read_shift(2);
    var flags = blob.read_shift(2), iTabCur = blob.read_shift(2), iTabFirst = blob.read_shift(2);
    var ctabSel = blob.read_shift(2), wTabRatio = blob.read_shift(2);
    return { Pos: [xWn, yWn], Dim: [dxWn, dyWn], Flags: flags, CurTab: iTabCur,
        FirstTab: iTabFirst, Selected: ctabSel, TabRatio: wTabRatio };
}

/* 2.4.122 TODO */
function parse_Font(blob, length, opts) {
    blob.l += 14;
    var name = parse_ShortXLUnicodeString(blob, 0, opts);
    return name;
}

/* 2.4.149 */
function parse_LabelSst(blob, length) {
    var cell = parse_XLSCell(blob);
    cell.isst = blob.read_shift(4);
    return cell;
}

/* 2.4.148 */
function parse_Label(blob, length, opts) {
    var cell = parse_XLSCell(blob, 6);
    var str = parse_XLUnicodeString(blob, length-6, opts);
    cell.val = str;
    return cell;
}

/* 2.4.126 Number Formats */
function parse_Format(blob, length, opts) {
    var ifmt = blob.read_shift(2);
    var fmtstr = parse_XLUnicodeString2(blob, 0, opts);
    return [ifmt, fmtstr];
}

/* 2.4.90 */
function parse_Dimensions(blob, length) {
    var w = length === 10 ? 2 : 4;
    var r = blob.read_shift(w), R = blob.read_shift(w),
        c = blob.read_shift(2), C = blob.read_shift(2);
    blob.l += 2;
    return {s: {r:r, c:c}, e: {r:R, c:C}};
}

/* 2.4.220 */
function parse_RK(blob, length) {
    var rw = blob.read_shift(2), col = blob.read_shift(2);
    var rkrec = parse_RkRec(blob);
    return {r:rw, c:col, ixfe:rkrec[0], rknum:rkrec[1]};
}

/* 2.4.175 */
function parse_MulRk(blob, length) {
    var target = blob.l + length - 2;
    var rw = blob.read_shift(2), col = blob.read_shift(2);
    var rkrecs = [];
    while(blob.l < target) rkrecs.push(parse_RkRec(blob));
    if(blob.l !== target) throw "MulRK read error";
    var lastcol = blob.read_shift(2);
    if(rkrecs.length != lastcol - col + 1) throw "MulRK length mismatch";
    return {r:rw, c:col, C:lastcol, rkrec:rkrecs};
}

/* 2.5.20 2.5.249 TODO */
function parse_CellStyleXF(blob, length, style) {
    var o = {};
    var a = blob.read_shift(4), b = blob.read_shift(4);
    var c = blob.read_shift(4), d = blob.read_shift(2);
    o.patternType = XLSFillPattern[c >> 26];
    o.icvFore = d & 0x7F;
    o.icvBack = (d >> 7) & 0x7F;
    return o;
}
function parse_CellXF(blob, length) {return parse_CellStyleXF(blob,length,0);}
function parse_StyleXF(blob, length) {return parse_CellStyleXF(blob,length,1);}

/* 2.4.353 TODO: actually do this right */
function parse_XF(blob, length) {
    var o = {};
    o.ifnt = blob.read_shift(2); o.ifmt = blob.read_shift(2); o.flags = blob.read_shift(2);
    o.fStyle = (o.flags >> 2) & 0x01;
    length -= 6;
    o.data = parse_CellStyleXF(blob, length, o.fStyle);
    return o;
}

/* 2.4.134 */
function parse_Guts(blob, length) {
    blob.l += 4;
    var out = [blob.read_shift(2), blob.read_shift(2)];
    if(out[0] !== 0) out[0]--;
    if(out[1] !== 0) out[1]--;
    if(out[0] > 7 || out[1] > 7) throw "Bad Gutters: " + out;
    return out;
}

/* 2.4.24 */
function parse_BoolErr(blob, length) {
    var cell = parse_XLSCell(blob, 6);
    var val = parse_Bes(blob, 2);
    cell.val = val;
    cell.t = (val === true || val === false) ? 'b' : 'e';
    return cell;
}

/* 2.4.180 Number */
function parse_Number(blob, length) {
    var cell = parse_XLSCell(blob, 6);
    var xnum = parse_Xnum(blob, 8);
    cell.val = xnum;
    return cell;
}

var parse_XLHeaderFooter = parse_OptXLUnicodeString; // TODO: parse 2.4.136

/* 2.4.271 */
function parse_SupBook(blob, length, opts) {
    var end = blob.l + length;
    var ctab = blob.read_shift(2);
    var cch = blob.read_shift(2);
    var virtPath;
    if(cch >=0x01 && cch <=0xff) virtPath = parse_XLUnicodeStringNoCch(blob, cch);
    var rgst = blob.read_shift(end - blob.l);
    opts.sbcch = cch;
    return [cch, ctab, virtPath, rgst];
}

/* 2.4.105 TODO */
function parse_ExternName(blob, length, opts) {
    var flags = blob.read_shift(2);
    var body;
    var o = {
        fBuiltIn: flags & 0x01,
        fWantAdvise: (flags >>> 1) & 0x01,
        fWantPict: (flags >>> 2) & 0x01,
        fOle: (flags >>> 3) & 0x01,
        fOleLink: (flags >>> 4) & 0x01,
        cf: (flags >>> 5) & 0x3FF,
        fIcon: flags >>> 15 & 0x01
    };
    if(opts.sbcch === 0x3A01) body = parse_AddinUdf(blob, length-2);
    //else throw new Error("unsupported SupBook cch: " + opts.sbcch);
    o.body = body || blob.read_shift(length-2);
    return o;
}

/* 2.4.150 TODO */
function parse_Lbl(blob, length, opts) {
    if(opts.biff < 8) return parse_Label(blob, length, opts);
    var target = blob.l + length;
    var flags = blob.read_shift(2);
    var chKey = blob.read_shift(1);
    var cch = blob.read_shift(1);
    var cce = blob.read_shift(2);
    blob.l += 2;
    var itab = blob.read_shift(2);
    blob.l += 4;
    var name = parse_XLUnicodeStringNoCch(blob, cch, opts);
    var rgce = parse_NameParsedFormula(blob, target - blob.l, opts, cce);
    return {
        chKey: chKey,
        Name: name,
        rgce: rgce
    };
}

/* 2.4.106 TODO: verify supbook manipulation */
function parse_ExternSheet(blob, length, opts) {
    if(opts.biff < 8) return parse_ShortXLUnicodeString(blob, length, opts);
    var o = parslurp2(blob,length,parse_XTI);
    var oo = [];
    if(opts.sbcch === 0x0401) {
        for(var i = 0; i != o.length; ++i) oo.push(opts.snames[o[i][1]]);
        return oo;
    }
    else return o;
}

/* 2.4.260 */
function parse_ShrFmla(blob, length, opts) {
    var ref = parse_RefU(blob, 6);
    blob.l++;
    var cUse = blob.read_shift(1);
    length -= 8;
    return [parse_SharedParsedFormula(blob, length, opts), cUse];
}

/* 2.4.4 TODO */
function parse_Array(blob, length, opts) {
    var ref = parse_Ref(blob, 6);
    blob.l += 6; length -= 12; /* TODO: fAlwaysCalc */
    return [ref, parse_ArrayParsedFormula(blob, length, opts, ref)];
}

/* 2.4.173 */
function parse_MTRSettings(blob, length) {
    var fMTREnabled = blob.read_shift(4) !== 0x00;
    var fUserSetThreadCount = blob.read_shift(4) !== 0x00;
    var cUserThreadCount = blob.read_shift(4);
    return [fMTREnabled, fUserSetThreadCount, cUserThreadCount];
}

/* 2.5.186 TODO: BIFF5 */
function parse_NoteSh(blob, length, opts) {
    if(opts.biff < 8) return;
    var row = blob.read_shift(2), col = blob.read_shift(2);
    var flags = blob.read_shift(2), idObj = blob.read_shift(2);
    var stAuthor = parse_XLUnicodeString2(blob, 0, opts);
    if(opts.biff < 8) blob.read_shift(1);
    return [{r:row,c:col}, stAuthor, idObj, flags];
}

/* 2.4.179 */
function parse_Note(blob, length, opts) {
    /* TODO: Support revisions */
    return parse_NoteSh(blob, length, opts);
}

/* 2.4.168 */
function parse_MergeCells(blob, length) {
    var merges = [];
    var cmcs = blob.read_shift(2);
    while (cmcs--) merges.push(parse_Ref8U(blob,length));
    return merges;
}

/* 2.4.181 TODO: parse all the things! */
function parse_Obj(blob, length) {
    var cmo = parse_FtCmo(blob, 22); // id, ot, flags
    var fts = parse_FtArray(blob, length-22, cmo[1]);
    return { cmo: cmo, ft:fts };
}

/* 2.4.329 TODO: parse properly */
function parse_TxO(blob, length, opts) {
    var s = blob.l;
try {
    blob.l += 4;
    var ot = (opts.lastobj||{cmo:[0,0]}).cmo[1];
    var controlInfo;
    if([0,5,7,11,12,14].indexOf(ot) == -1) blob.l += 6;
    else controlInfo = parse_ControlInfo(blob, 6, opts);
    var cchText = blob.read_shift(2);
    var cbRuns = blob.read_shift(2);
    var ifntEmpty = parse_FontIndex(blob, 2);
    var len = blob.read_shift(2);
    blob.l += len;
    //var fmla = parse_ObjFmla(blob, s + length - blob.l);

    var texts = "";
    for(var i = 1; i < blob.lens.length-1; ++i) {
        if(blob.l-s != blob.lens[i]) throw "TxO: bad continue record";
        var hdr = blob[blob.l];
        var t = parse_XLUnicodeStringNoCch(blob, blob.lens[i+1]-blob.lens[i]-1);
        texts += t;
        if(texts.length >= (hdr ? cchText : 2*cchText)) break;
    }
    if(texts.length !== cchText && texts.length !== cchText*2) {
        throw "cchText: " + cchText + " != " + texts.length;
    }

    blob.l = s + length;
    /* 2.5.272 TxORuns */
//  var rgTxoRuns = [];
//  for(var j = 0; j != cbRuns/8-1; ++j) blob.l += 8;
//  var cchText2 = blob.read_shift(2);
//  if(cchText2 !== cchText) throw "TxOLastRun mismatch: " + cchText2 + " " + cchText;
//  blob.l += 6;
//  if(s + length != blob.l) throw "TxO " + (s + length) + ", at " + blob.l;
    return { t: texts };
} catch(e) { blob.l = s + length; return { t: texts||"" }; }
}

/* 2.4.140 */
var parse_HLink = function(blob, length) {
    var ref = parse_Ref8U(blob, 8);
    blob.l += 16; /* CLSID */
    var hlink = parse_Hyperlink(blob, length-24);
    return [ref, hlink];
};

/* 2.4.141 */
var parse_HLinkTooltip = function(blob, length) {
    var end = blob.l + length;
    blob.read_shift(2);
    var ref = parse_Ref8U(blob, 8);
    var wzTooltip = blob.read_shift((length-10)/2, 'dbcs-cont');
    wzTooltip = wzTooltip.replace(chr0,"");
    return [ref, wzTooltip];
};

/* 2.4.63 */
function parse_Country(blob, length) {
    var o = [], d;
    d = blob.read_shift(2); o[0] = CountryEnum[d] || d;
    d = blob.read_shift(2); o[1] = CountryEnum[d] || d;
    return o;
}

/* 2.4.50 ClrtClient */
function parse_ClrtClient(blob, length) {
    var ccv = blob.read_shift(2);
    var o = [];
    while(ccv-->0) o.push(parse_LongRGB(blob, 8));
    return o;
}

/* 2.4.188 */
function parse_Palette(blob, length) {
    var ccv = blob.read_shift(2);
    var o = [];
    while(ccv-->0) o.push(parse_LongRGB(blob, 8));
    return o;
}

/* 2.4.354 */
function parse_XFCRC(blob, length) {
    blob.l += 2;
    var o = {cxfs:0, crc:0};
    o.cxfs = blob.read_shift(2);
    o.crc = blob.read_shift(4);
    return o;
}


var parse_Style = parsenoop;
var parse_StyleExt = parsenoop;

var parse_ColInfo = parsenoop;

var parse_Window2 = parsenoop;


var parse_Backup = parsebool; /* 2.4.14 */
var parse_Blank = parse_XLSCell; /* 2.4.20 Just the cell */
var parse_BottomMargin = parse_Xnum; /* 2.4.27 */
var parse_BuiltInFnGroupCount = parseuint16; /* 2.4.30 0x0E or 0x10 but excel 2011 generates 0x11? */
var parse_CalcCount = parseuint16; /* 2.4.31 #Iterations */
var parse_CalcDelta = parse_Xnum; /* 2.4.32 */
var parse_CalcIter = parsebool;  /* 2.4.33 1=iterative calc */
var parse_CalcMode = parseuint16; /* 2.4.34 0=manual, 1=auto (def), 2=table */
var parse_CalcPrecision = parsebool; /* 2.4.35 */
var parse_CalcRefMode = parsenoop2; /* 2.4.36 */
var parse_CalcSaveRecalc = parsebool; /* 2.4.37 */
var parse_CodePage = parseuint16; /* 2.4.52 */
var parse_Compat12 = parsebool; /* 2.4.54 true = no compatibility check */
var parse_Date1904 = parsebool; /* 2.4.77 - 1=1904,0=1900 */
var parse_DefColWidth = parseuint16; /* 2.4.89 */
var parse_DSF = parsenoop2; /* 2.4.94 -- MUST be ignored */
var parse_EntExU2 = parsenoop2; /* 2.4.102 -- Explicitly says to ignore */
var parse_EOF = parsenoop2; /* 2.4.103 */
var parse_Excel9File = parsenoop2; /* 2.4.104 -- Optional and unused */
var parse_FeatHdr = parsenoop2; /* 2.4.112 */
var parse_FontX = parseuint16; /* 2.4.123 */
var parse_Footer = parse_XLHeaderFooter; /* 2.4.124 */
var parse_GridSet = parseuint16; /* 2.4.132, =1 */
var parse_HCenter = parsebool; /* 2.4.135 sheet centered horizontal on print */
var parse_Header = parse_XLHeaderFooter; /* 2.4.136 */
var parse_HideObj = parse_HideObjEnum; /* 2.4.139 */
var parse_InterfaceEnd = parsenoop2; /* 2.4.145 -- noop */
var parse_LeftMargin = parse_Xnum; /* 2.4.151 */
var parse_Mms = parsenoop2; /* 2.4.169 -- Explicitly says to ignore */
var parse_ObjProtect = parsebool; /* 2.4.183 -- must be 1 if present */
var parse_Password = parseuint16; /* 2.4.191 */
var parse_PrintGrid = parsebool; /* 2.4.202 */
var parse_PrintRowCol = parsebool; /* 2.4.203 */
var parse_PrintSize = parseuint16; /* 2.4.204 0:3 */
var parse_Prot4Rev = parsebool; /* 2.4.205 */
var parse_Prot4RevPass = parseuint16; /* 2.4.206 */
var parse_Protect = parsebool; /* 2.4.207 */
var parse_RefreshAll = parsebool; /* 2.4.217 -- must be 0 if not template */
var parse_RightMargin = parse_Xnum; /* 2.4.219 */
var parse_RRTabId = parseuint16a; /* 2.4.241 */
var parse_ScenarioProtect = parsebool; /* 2.4.245 */
var parse_Scl = parseuint16a; /* 2.4.247 num, den */
var parse_String = parse_XLUnicodeString; /* 2.4.268 */
var parse_SxBool = parsebool; /* 2.4.274 */
var parse_TopMargin = parse_Xnum; /* 2.4.328 */
var parse_UsesELFs = parsebool; /* 2.4.337 -- should be 0 */
var parse_VCenter = parsebool; /* 2.4.342 */
var parse_WinProtect = parsebool; /* 2.4.347 */
var parse_WriteProtect = parsenoop; /* 2.4.350 empty record */


/* ---- */
var parse_VerticalPageBreaks = parsenoop;
var parse_HorizontalPageBreaks = parsenoop;
var parse_Selection = parsenoop;
var parse_Continue = parsenoop;
var parse_Pane = parsenoop;
var parse_Pls = parsenoop;
var parse_DCon = parsenoop;
var parse_DConRef = parsenoop;
var parse_DConName = parsenoop;
var parse_XCT = parsenoop;
var parse_CRN = parsenoop;
var parse_FileSharing = parsenoop;
var parse_Uncalced = parsenoop;
var parse_Template = parsenoop;
var parse_Intl = parsenoop;
var parse_WsBool = parsenoop;
var parse_Sort = parsenoop;
var parse_Sync = parsenoop;
var parse_LPr = parsenoop;
var parse_DxGCol = parsenoop;
var parse_FnGroupName = parsenoop;
var parse_FilterMode = parsenoop;
var parse_AutoFilterInfo = parsenoop;
var parse_AutoFilter = parsenoop;
var parse_Setup = parsenoop;
var parse_ScenMan = parsenoop;
var parse_SCENARIO = parsenoop;
var parse_SxView = parsenoop;
var parse_Sxvd = parsenoop;
var parse_SXVI = parsenoop;
var parse_SxIvd = parsenoop;
var parse_SXLI = parsenoop;
var parse_SXPI = parsenoop;
var parse_DocRoute = parsenoop;
var parse_RecipName = parsenoop;
var parse_MulBlank = parsenoop;
var parse_SXDI = parsenoop;
var parse_SXDB = parsenoop;
var parse_SXFDB = parsenoop;
var parse_SXDBB = parsenoop;
var parse_SXNum = parsenoop;
var parse_SxErr = parsenoop;
var parse_SXInt = parsenoop;
var parse_SXString = parsenoop;
var parse_SXDtr = parsenoop;
var parse_SxNil = parsenoop;
var parse_SXTbl = parsenoop;
var parse_SXTBRGIITM = parsenoop;
var parse_SxTbpg = parsenoop;
var parse_ObProj = parsenoop;
var parse_SXStreamID = parsenoop;
var parse_DBCell = parsenoop;
var parse_SXRng = parsenoop;
var parse_SxIsxoper = parsenoop;
var parse_BookBool = parsenoop;
var parse_DbOrParamQry = parsenoop;
var parse_OleObjectSize = parsenoop;
var parse_SXVS = parsenoop;
var parse_BkHim = parsenoop;
var parse_MsoDrawingGroup = parsenoop;
var parse_MsoDrawing = parsenoop;
var parse_MsoDrawingSelection = parsenoop;
var parse_PhoneticInfo = parsenoop;
var parse_SxRule = parsenoop;
var parse_SXEx = parsenoop;
var parse_SxFilt = parsenoop;
var parse_SxDXF = parsenoop;
var parse_SxItm = parsenoop;
var parse_SxName = parsenoop;
var parse_SxSelect = parsenoop;
var parse_SXPair = parsenoop;
var parse_SxFmla = parsenoop;
var parse_SxFormat = parsenoop;
var parse_SXVDEx = parsenoop;
var parse_SXFormula = parsenoop;
var parse_SXDBEx = parsenoop;
var parse_RRDInsDel = parsenoop;
var parse_RRDHead = parsenoop;
var parse_RRDChgCell = parsenoop;
var parse_RRDRenSheet = parsenoop;
var parse_RRSort = parsenoop;
var parse_RRDMove = parsenoop;
var parse_RRFormat = parsenoop;
var parse_RRAutoFmt = parsenoop;
var parse_RRInsertSh = parsenoop;
var parse_RRDMoveBegin = parsenoop;
var parse_RRDMoveEnd = parsenoop;
var parse_RRDInsDelBegin = parsenoop;
var parse_RRDInsDelEnd = parsenoop;
var parse_RRDConflict = parsenoop;
var parse_RRDDefName = parsenoop;
var parse_RRDRstEtxp = parsenoop;
var parse_LRng = parsenoop;
var parse_CUsr = parsenoop;
var parse_CbUsr = parsenoop;
var parse_UsrInfo = parsenoop;
var parse_UsrExcl = parsenoop;
var parse_FileLock = parsenoop;
var parse_RRDInfo = parsenoop;
var parse_BCUsrs = parsenoop;
var parse_UsrChk = parsenoop;
var parse_UserBView = parsenoop;
var parse_UserSViewBegin = parsenoop; // overloaded
var parse_UserSViewEnd = parsenoop;
var parse_RRDUserView = parsenoop;
var parse_Qsi = parsenoop;
var parse_CondFmt = parsenoop;
var parse_CF = parsenoop;
var parse_DVal = parsenoop;
var parse_DConBin = parsenoop;
var parse_Lel = parsenoop;
var parse_XLSCodeName = parse_XLUnicodeString;
var parse_SXFDBType = parsenoop;
var parse_ObNoMacros = parsenoop;
var parse_Dv = parsenoop;
var parse_Index = parsenoop;
var parse_Table = parsenoop;
var parse_BigName = parsenoop;
var parse_ContinueBigName = parsenoop;
var parse_WebPub = parsenoop;
var parse_QsiSXTag = parsenoop;
var parse_DBQueryExt = parsenoop;
var parse_ExtString = parsenoop;
var parse_TxtQry = parsenoop;
var parse_Qsir = parsenoop;
var parse_Qsif = parsenoop;
var parse_RRDTQSIF = parsenoop;
var parse_OleDbConn = parsenoop;
var parse_WOpt = parsenoop;
var parse_SXViewEx = parsenoop;
var parse_SXTH = parsenoop;
var parse_SXPIEx = parsenoop;
var parse_SXVDTEx = parsenoop;
var parse_SXViewEx9 = parsenoop;
var parse_ContinueFrt = parsenoop;
var parse_RealTimeData = parsenoop;
var parse_ChartFrtInfo = parsenoop;
var parse_FrtWrapper = parsenoop;
var parse_StartBlock = parsenoop;
var parse_EndBlock = parsenoop;
var parse_StartObject = parsenoop;
var parse_EndObject = parsenoop;
var parse_CatLab = parsenoop;
var parse_YMult = parsenoop;
var parse_SXViewLink = parsenoop;
var parse_PivotChartBits = parsenoop;
var parse_FrtFontList = parsenoop;
var parse_SheetExt = parsenoop;
var parse_BookExt = parsenoop;
var parse_SXAddl = parsenoop;
var parse_CrErr = parsenoop;
var parse_HFPicture = parsenoop;
var parse_Feat = parsenoop;
var parse_DataLabExt = parsenoop;
var parse_DataLabExtContents = parsenoop;
var parse_CellWatch = parsenoop;
var parse_FeatHdr11 = parsenoop;
var parse_Feature11 = parsenoop;
var parse_DropDownObjIds = parsenoop;
var parse_ContinueFrt11 = parsenoop;
var parse_DConn = parsenoop;
var parse_List12 = parsenoop;
var parse_Feature12 = parsenoop;
var parse_CondFmt12 = parsenoop;
var parse_CF12 = parsenoop;
var parse_CFEx = parsenoop;
var parse_AutoFilter12 = parsenoop;
var parse_ContinueFrt12 = parsenoop;
var parse_MDTInfo = parsenoop;
var parse_MDXStr = parsenoop;
var parse_MDXTuple = parsenoop;
var parse_MDXSet = parsenoop;
var parse_MDXProp = parsenoop;
var parse_MDXKPI = parsenoop;
var parse_MDB = parsenoop;
var parse_PLV = parsenoop;
var parse_DXF = parsenoop;
var parse_TableStyles = parsenoop;
var parse_TableStyle = parsenoop;
var parse_TableStyleElement = parsenoop;
var parse_NamePublish = parsenoop;
var parse_NameCmt = parsenoop;
var parse_SortData = parsenoop;
var parse_GUIDTypeLib = parsenoop;
var parse_FnGrp12 = parsenoop;
var parse_NameFnGrp12 = parsenoop;
var parse_HeaderFooter = parsenoop;
var parse_CrtLayout12 = parsenoop;
var parse_CrtMlFrt = parsenoop;
var parse_CrtMlFrtContinue = parsenoop;
var parse_ShapePropsStream = parsenoop;
var parse_TextPropsStream = parsenoop;
var parse_RichTextStream = parsenoop;
var parse_CrtLayout12A = parsenoop;
var parse_Units = parsenoop;
var parse_Chart = parsenoop;
var parse_Series = parsenoop;
var parse_DataFormat = parsenoop;
var parse_LineFormat = parsenoop;
var parse_MarkerFormat = parsenoop;
var parse_AreaFormat = parsenoop;
var parse_PieFormat = parsenoop;
var parse_AttachedLabel = parsenoop;
var parse_SeriesText = parsenoop;
var parse_ChartFormat = parsenoop;
var parse_Legend = parsenoop;
var parse_SeriesList = parsenoop;
var parse_Bar = parsenoop;
var parse_Line = parsenoop;
var parse_Pie = parsenoop;
var parse_Area = parsenoop;
var parse_Scatter = parsenoop;
var parse_CrtLine = parsenoop;
var parse_Axis = parsenoop;
var parse_Tick = parsenoop;
var parse_ValueRange = parsenoop;
var parse_CatSerRange = parsenoop;
var parse_AxisLine = parsenoop;
var parse_CrtLink = parsenoop;
var parse_DefaultText = parsenoop;
var parse_Text = parsenoop;
var parse_ObjectLink = parsenoop;
var parse_Frame = parsenoop;
var parse_Begin = parsenoop;
var parse_End = parsenoop;
var parse_PlotArea = parsenoop;
var parse_Chart3d = parsenoop;
var parse_PicF = parsenoop;
var parse_DropBar = parsenoop;
var parse_Radar = parsenoop;
var parse_Surf = parsenoop;
var parse_RadarArea = parsenoop;
var parse_AxisParent = parsenoop;
var parse_LegendException = parsenoop;
var parse_ShtProps = parsenoop;
var parse_SerToCrt = parsenoop;
var parse_AxesUsed = parsenoop;
var parse_SBaseRef = parsenoop;
var parse_SerParent = parsenoop;
var parse_SerAuxTrend = parsenoop;
var parse_IFmtRecord = parsenoop;
var parse_Pos = parsenoop;
var parse_AlRuns = parsenoop;
var parse_BRAI = parsenoop;
var parse_SerAuxErrBar = parsenoop;
var parse_SerFmt = parsenoop;
var parse_Chart3DBarShape = parsenoop;
var parse_Fbi = parsenoop;
var parse_BopPop = parsenoop;
var parse_AxcExt = parsenoop;
var parse_Dat = parsenoop;
var parse_PlotGrowth = parsenoop;
var parse_SIIndex = parsenoop;
var parse_GelFrame = parsenoop;
var parse_BopPopCustom = parsenoop;
var parse_Fbi2 = parsenoop;

/* --- Specific to versions before BIFF8 --- */
function parse_BIFF5String(blob) {
    var len = blob.read_shift(1);
    return blob.read_shift(len, 'sbcs-cont');
}

/* BIFF2_??? where ??? is the name from [XLS] */
function parse_BIFF2STR(blob, length, opts) {
    var cell = parse_XLSCell(blob, 6);
    ++blob.l;
    var str = parse_XLUnicodeString2(blob, length-7, opts);
    cell.val = str;
    return cell;
}

function parse_BIFF2NUM(blob, length, opts) {
    var cell = parse_XLSCell(blob, 6);
    ++blob.l;
    var num = parse_Xnum(blob, 8);
    cell.val = num;
    return cell;
}

/* 18.4.1 charset to codepage mapping */
var CS2CP = {
    0:    1252, /* ANSI */
    1:   65001, /* DEFAULT */
    2:   65001, /* SYMBOL */
    77:  10000, /* MAC */
    128:   932, /* SHIFTJIS */
    129:   949, /* HANGUL */
    130:  1361, /* JOHAB */
    134:   936, /* GB2312 */
    136:   950, /* CHINESEBIG5 */
    161:  1253, /* GREEK */
    162:  1254, /* TURKISH */
    163:  1258, /* VIETNAMESE */
    177:  1255, /* HEBREW */
    178:  1256, /* ARABIC */
    186:  1257, /* BALTIC */
    204:  1251, /* RUSSIAN */
    222:   874, /* THAI */
    238:  1250, /* EASTEUROPE */
    255:  1252, /* OEM */
    69:   6969  /* MISC */
};

/* Parse a list of <r> tags */
var parse_rs = (function parse_rs_factory() {
    var tregex = matchtag("t"), rpregex = matchtag("rPr"), rregex = /<r>/g, rend = /<\/r>/, nlregex = /\r\n/g;
    /* 18.4.7 rPr CT_RPrElt */
    var parse_rpr = function parse_rpr(rpr, intro, outro) {
        var font = {}, cp = 65001;
        var m = rpr.match(tagregex), i = 0;
        if(m) for(;i!=m.length; ++i) {
            var y = parsexmltag(m[i]);
            switch(y[0]) {
                /* 18.8.12 condense CT_BooleanProperty */
                /* ** not required . */
                case '<condense': break;
                /* 18.8.17 extend CT_BooleanProperty */
                /* ** not required . */
                case '<extend': break;
                /* 18.8.36 shadow CT_BooleanProperty */
                /* ** not required . */
                case '<shadow':
                    /* falls through */
                case '<shadow/>': break;

                /* 18.4.1 charset CT_IntProperty TODO */
                case '<charset':
                    if(y.val == '1') break;
                    cp = CS2CP[parseInt(y.val, 10)];
                    break;

                /* 18.4.2 outline CT_BooleanProperty TODO */
                case '<outline':
                    /* falls through */
                case '<outline/>': break;

                /* 18.4.5 rFont CT_FontName */
                case '<rFont': font.name = y.val; break;

                /* 18.4.11 sz CT_FontSize */
                case '<sz': font.sz = y.val; break;

                /* 18.4.10 strike CT_BooleanProperty */
                case '<strike':
                    if(!y.val) break;
                    /* falls through */
                case '<strike/>': font.strike = 1; break;
                case '</strike>': break;

                /* 18.4.13 u CT_UnderlineProperty */
                case '<u':
                    if(!y.val) break;
                    /* falls through */
                case '<u/>': font.u = 1; break;
                case '</u>': break;

                /* 18.8.2 b */
                case '<b':
                    if(!y.val) break;
                    /* falls through */
                case '<b/>': font.b = 1; break;
                case '</b>': break;

                /* 18.8.26 i */
                case '<i':
                    if(!y.val) break;
                    /* falls through */
                case '<i/>': font.i = 1; break;
                case '</i>': break;

                /* 18.3.1.15 color CT_Color TODO: tint, theme, auto, indexed */
                case '<color':
                    if(y.rgb) font.color = y.rgb.substr(2,6);
                    break;

                /* 18.8.18 family ST_FontFamily */
                case '<family': font.family = y.val; break;

                /* 18.4.14 vertAlign CT_VerticalAlignFontProperty TODO */
                case '<vertAlign': break;

                /* 18.8.35 scheme CT_FontScheme TODO */
                case '<scheme': break;

                default:
                    if(y[0].charCodeAt(1) !== 47) throw 'Unrecognized rich format ' + y[0];
            }
        }
        /* TODO: These should be generated styles, not inline */
        var style = [];
        if(font.b) style.push("font-weight: bold;");
        if(font.i) style.push("font-style: italic;");
        intro.push('<span style="' + style.join("") + '">');
        outro.push("</span>");
        return cp;
    };

    /* 18.4.4 r CT_RElt */
    function parse_r(r) {
        var terms = [[],"",[]];
        /* 18.4.12 t ST_Xstring */
        var t = r.match(tregex), cp = 65001;
        if(!isval(t)) return "";
        terms[1] = t[1];

        var rpr = r.match(rpregex);
        if(isval(rpr)) cp = parse_rpr(rpr[1], terms[0], terms[2]);

        return terms[0].join("") + terms[1].replace(nlregex,'<br/>') + terms[2].join("");
    }
    return function parse_rs(rs) {
        return rs.replace(rregex,"").split(rend).map(parse_r).join("");
    };
})();

/* 18.4.8 si CT_Rst */
var sitregex = /<t[^>]*>([^<]*)<\/t>/g, sirregex = /<r>/;
function parse_si(x, opts) {
    var html = opts ? opts.cellHTML : true;
    var z = {};
    if(!x) return null;
    var y;
    /* 18.4.12 t ST_Xstring (Plaintext String) */
    if(x.charCodeAt(1) === 116) {
        z.t = utf8read(unescapexml(x.substr(x.indexOf(">")+1).split(/<\/t>/)[0]));
        z.r = x;
        if(html) z.h = z.t;
    }
    /* 18.4.4 r CT_RElt (Rich Text Run) */
    else if((y = x.match(sirregex))) {
        z.r = x;
        z.t = utf8read(unescapexml(x.match(sitregex).join("").replace(tagregex,"")));
        if(html) z.h = parse_rs(x);
    }
    /* 18.4.3 phoneticPr CT_PhoneticPr (TODO: needed for Asian support) */
    /* 18.4.6 rPh CT_PhoneticRun (TODO: needed for Asian support) */
    return z;
}

/* 18.4 Shared String Table */
var sstr0 = /<sst([^>]*)>([\s\S]*)<\/sst>/;
var sstr1 = /<(?:si|sstItem)>/g;
var sstr2 = /<\/(?:si|sstItem)>/;
function parse_sst_xml(data, opts) {
    var s = [], ss;
    /* 18.4.9 sst CT_Sst */
    var sst = data.match(sstr0);
    if(isval(sst)) {
        ss = sst[2].replace(sstr1,"").split(sstr2);
        for(var i = 0; i != ss.length; ++i) {
            var o = parse_si(ss[i], opts);
            if(o != null) s[s.length] = o;
        }
        sst = parsexmltag(sst[1]); s.Count = sst.count; s.Unique = sst.uniqueCount;
    }
    return s;
}

RELS.SST = "http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings";
var straywsregex = /^\s|\s$|[\t\n\r]/;
function write_sst_xml(sst, opts) {
    if(!opts.bookSST) return "";
    var o = [XML_HEADER];
    o[o.length] = (writextag('sst', null, {
        xmlns: XMLNS.main[0],
        count: sst.Count,
        uniqueCount: sst.Unique
    }));
    for(var i = 0; i != sst.length; ++i) { if(sst[i] == null) continue;
        var s = sst[i];
        var sitag = "<si>";
        if(s.r) sitag += s.r;
        else {
            sitag += "<t";
            if(s.t.match(straywsregex)) sitag += ' xml:space="preserve"';
            sitag += ">" + escapexml(s.t) + "</t>";
        }
        sitag += "</si>";
        o[o.length] = (sitag);
    }
    if(o.length>2){ o[o.length] = ('</sst>'); o[1]=o[1].replace("/>",">"); }
    return o.join("");
}
/* [MS-XLSB] 2.4.219 BrtBeginSst */
function parse_BrtBeginSst(data, length) {
    return [data.read_shift(4), data.read_shift(4)];
}

/* [MS-XLSB] 2.1.7.45 Shared Strings */
function parse_sst_bin(data, opts) {
    var s = [];
    var pass = false;
    recordhopper(data, function hopper_sst(val, R, RT) {
        switch(R.n) {
            case 'BrtBeginSst': s.Count = val[0]; s.Unique = val[1]; break;
            case 'BrtSS‚1şÖ¼†‚lbJôæö;8İ(º»%Œ€Ôƒ#)6BP×g¾Ã¾ù]’ÜbÖu)ejòäõßÃ1rM”cA&…Ó"%@®ORNûŒÒö†¯ÀÂOñÀ7÷2Í*Ğ&†ƒìç˜gÈY€Í, â§…sUÌ³O­"*”>&Ÿ.Ù|ªkLâZÉ†Û!™!Tß'lJ§ù×B şÜ]Ó$­¯°÷®*º•Û·]ğŞê¹³IFã¯\NìÁJ®4¨È"r™A˜“×<¿Ñ8(]©˜Ç$¡»;´7”b6ßRáhäzÛ‘®zŸad3ÓDûşöDy Çv¦ıö9ÕDS‚OIõ»¸yc*r'¿¡Ì|õ9çéu-â¹;Kë4—Y³3w$jd*ü,^•ä¾W’BBˆİÈÇq–ÇbÎt»_J<8!ØÙşÌÌÃ^yÜ¹¦.êcR¿NdŞÎ Øş±yÄ5GÚ÷ğÊ2/yì—fººc@+CŞ€W5’6	ssÑ|»jl´‹+c³ˆÃÉ_ç“ã'ñÏ%×æñu3ï¡î0,‚\«›Yey³ihíÀU£‰U¤}ùk´FÔÈhíŠ¶§
·]…+OëÀP¦ØªÓ\!.0R·ÛÌšÅÈ«°¥ÕÈ«G$•¤ã²­'Xwş˜¥m~ì‰C`åj¦ìw§ÑåZ  “‘*·•D*ÉM©€•+xøôÂw
í¶È’«ğÅ’Ò{a+I¦*Ñ8oehšà’Ğßn‡Ã"U³·Ë­¨UcšrtJTØïLš¬-±?‡¾”;5iRxíáyæn1 ©=ş@w'¶[É!‹%! ¶§t·S* ˆ¡êOül{œôÎìøày<Ïã¢Ê\!0TU… <=³¡ŒiÄ2´¾úñ½3ÄĞvÉ“²E$¹»+7R<IÊÍ²­öb—ÓúÌê>ÇWéAß##L€a×ßYåˆRş}Çvús
rêÊÓmĞš;
»îÇ§\óÔÖøÓ±ÈrılÃ:ÒíªŠußåœYÙlÖ
 :`„iJiĞó"#vÄ=«— Å½²}Pª:ä‚{e‚¼{ä¨*ñÓç‘(luÃJª0õW2Ô{d¹%,U1!’K¨[†nÆ¹‹’Ì0û.pkW(>øBö« +úë…ìÜ4±ó2ûÛlp²Ø–U$†şa¸§\í—E4+4@šrS¹öÁ(Øcp”/Õ"K¤šƒŸÙ`z‘ã•Pâ¶FÌi7Y@N
´lÍÙ×˜ïhI¥hÓ•)_¸dm•[Õä3FÜÃÔPõ‹3³›ÌI"{ÍBŞÍ~ÕÄË*Z­·ú æ£Y›ÂÅ)ÿ 6$ş¯µ¾Ş³+AÒ» :ñş+«ø±)”5 ~¬Ìf•‘Ş™²qÚÂ•§"U¬
ÑñÀ•£´Frâ
®ÂRì­…V0û²%HÂ–¶?çß]¶[×"­üğ*ÒwÅ[Å.'
VbUiÁj´à	S®%\ÈRš}8«D£V€r(q¬;cjĞ$‘Nƒ®Å+NØ¥a8J­¯İ„%ÕÆÕªÓ y«ªÏ´r|Ò¤ì)òÄw*›wéß'iR-_‡±ËTİ•A,@P*Xô u'æ¬fæíµKºn¶1PÀ‡«î~}¼w=— EËê?g—ëf}!0QÁT¦ËÓo
gQ\œN|Ô®¦	ÿ Øÿ –‚ÇŸ$Šæè}³ğ¨è=²ÙÂÆõ‹ø€*Bz~¬ÒÓÖ¯¤Xş¥‡ã¸#¯å¯¾cÌÙ¤’—ÙÇê:€6®ã®ı†sİ­ªàÇÂ9Ëî@ïF³n °İVy¾£ l™XÛĞn3WvØÂ‡aN›¾R¦£¢]†ÔË )Š&1½{f@ßt+®ÕÉ¡V2A
‹¶LZíZ¹0«éúğrUÊvëŠ‚GõÉ¥x;aÕ¦Z‚N>J–İÄµeSÃ¹¢óñôæ#–<–Ÿ~ÙèÎË‹JóL‚dh2[p§Ó‘j8õ^™ÙHî
`«Cñîv÷É×}Ê[ŒŠIì}²®Û¸ö°U½_MJùpÙÅ²—êëµ+úò2;& ’Å¯”Ñ‹ußzş‹72)o•ãú×™Í·ÕI—nŒiŸ¼ç!ín4‡YÇô–ÎG†­¿CÜgœˆ”ÊŸ«3"(SË3kMr	hŒ…§ Um{aK±*Ñß"UÃß¸Ÿ»
\--°Ãj·½;douhÿ ·ˆ)v*´í‹%œÆÔÈ•\xäPÖÄœ)vV)[Ûßhó¥£€*‘®øJ´6ï•Ú:àV˜í·\RÖÁ^F•iÄªÃÓ®*í©¶–‰û±¥ZN!+	U•
]\[ğÂFéw¾
U¬Ù5Rnõ;a¥Qgıx¥L’>y>A,V¿76ûµ4¹~Å‡ìà?k:nÈÑ–Cú¿¯õ6DPµ8Ô/MÁ5>>ùÛaÍ9%º)¥HĞ15#îÌ¡³M“]^úJÔ…/Ï"Kh;ª_ˆÓí|]ûñ	,?RÔi‰©éõ©9TäÅ‹¼®Ì©ö¥rK1÷Ì|“–½Ë(Ğ´şEY¾Ÿ™Ï5íYÉ3/Å7 ô.Ë‚mëœ¦l–Ú¼t 1‹R™Æ€/O^bÁ€m–F®”ràÅ\l2EUÿ !€1\Z
¯®*UÕÉÄªá°÷=²Ë
¨D¡rŒ7J¿·¶)BÎ€ƒ€¤æ˜š×Y³»QHîb0¿xš À¶u¾ÍeÚxúİş†Dìi÷XG¶Â½sĞ`l8“m3—|¸dQ\£ÔBFì~Íq#fEJEeS·#ûYL¬ªü‘Ã•§ernƒÕîD1’İ~Šf.CAÈ•ŞHOQõãûm+òP\ÄgœûK–å÷Ëô6}n ğíœÆ1AŠ>2*()™l,'¶lBÎùhœR°œŠ“-V»b®ùäUØ«k¶ø
»hö²6«qWvÅ-tÆÒµ·¨Å*é‘2VÇZ÷ñöÊÉê…ÃaˆVğ¥Í¿ÓŠV‘Š¸áU‡ı¬)S=ğ«i¶T†ü{aè«HÚ¸Ñ!+EO\FÅ\İp•„øaUµÀUÆµÈªÃ·ÏÉXwÂ••4È­ü°ÄZº£¾
İ-Ö£l*¤Í×*“¾àJ;ŸÇ$
RcT6çêvÍş–â¬ßHhûŸÙÍ—ghN¢|Gèoı,ãHÀŠÚ¬Îâ+eøZW4§bO¹9ßãˆˆ³°m6Mhönñ¯EA·ˆÍ8G¥·3³• ^§Ç[zIu¨$1²WqZ Ãõ-@HX)Ú¤±=j1%†ìZîçÔ›“1)Ø^Ü¿³1Éê‰nŞº›‘Üœæ{[UC€|R zV‡cE@EHÏ;ÔåmÆÎª è3Qv[ˆb§LÌ€¦%£mºä¬ôb¬ƒl¸!X~>=¬»’(*€íŠ 7©"¾4ùäíW|°Zß'{ªğrËUêwÀª¨8óUÛdÕIÇ_$¥‹y¿L“PÒd)k»V6ê:±¼”{²×3û;Sù}Dfy¸³	ƒ|³@\4mBÍ¯ŠMys(…•ÇÕs48›«©xœğ]öÉ;k2ÈšuëòÊÙ¥×(ªH§"İ	ìS-›jÃÏ<Ã#-ÌˆÂ¦ { zS0sÊœˆ™O“¢á¤«*ÿ y4Qà_Ô3Ì;{-ëè#lÂ»ñ­?^i¡Dš`ˆ³2$–%•›iÈªÆ"¸¥i®[¿ã[ ìÅ.¦ø
¶?^A\WÇ$UÔ?FEZ"€ø
©Ò½<0+°¥ÔÈªÓ^˜:¥B”8¸
BêÃ¸	hşY!Ikı¼J´N*°œªŸ‰Ä•j¿vD”¶MHl«TáW¹È*×8óJ˜Øàä«¦ä®'©±®Ø:lªRV›wÁj·‹u?F6—Pÿ fVˆÚ¸m-Û
¨Hı@É¨ò;øa)N±«®¾œ4{Ç^H§p€şÓÔ;æ~‹G-DÏHgôÓÜÎ1´‚Ò5–Rd•Ï7v5,Íß;ÌD" y l!^Œ€?iXTü;æÎ1Ú‹A;ØBŞN•V /ôËÉ¦-$¼½UCBG±Üš•Ûg0İFıå‘ÕE¸'uÂXÈôcÚ…×İë¿ñÊäZÊDòz&á¯rsS›‚6¼ƒ1òİ‰øY…w¾ùçzìÄ’SŞ›¥Ú„UØ³’Í;m	ı¼\H aÇ
İ%0‰h3$¶*é“´+(¨Ëv(V?^L!zì*p”ëR|0©òÉ*îß-±Wd‚
õÉ
Uã¦İpªªŸ•*à|vÉ*×ÉsJqÜuƒ‚CfA€jºoè›ç¾µøln² éÍíü¬wö9ÛviñV	ŸPú¤;½ãí!²s¤Ü™T¥Wmºüó·Œ­Å „Ü™$£(Ømìrë%¬€ÂH^ q~§Ş¹R>I~©Í¢'€Ü“”ÍÈÇO7×‡«ráM ¥|*zÖê7.Diå$ã£Z%~ÒûØç”v¬ï]’ûè|K(†.ıOsï˜Pˆ,
aÒ•ß3€¦,—¡ÌçªÖ¹YNØ«T¨İ1Vğ%Æ˜•vØª	híü0hô¥~ŒŠ©W·L
ìUØ±ºŠ¬ÃjÙè?VD«LÛĞdJ¸šá‚Ò²µë’µvãn§´´iŠ¬"ƒ|
´w8´\Šl²[%gõÃjâ?ÛÈ’•Œ6« ÊĞ¾´ä™,å´--¾M­cZ|UZN©³vÉ•k9ë\;%E¤ş˜H·R~ü•¥+Ö5TÓ¡â£Ô»I@?¿Égèô’ÔKº#™ıÏîgÙcVñË+5Äìf™Ï6sÕ›¥}³»ÓáŒ"#@rr“8¢*)J1"¿<ÚBÓ)(^¹‰x±¤•ûûeü˜|’›’I©Ü‘×ø`HÙêÚ‚Fj:E}üqEìÄ&¹
Í+Ø–ßøà‘j¦;upï#K#nh{xf<¥[²WÑ úÌŞ¡ Ñ>}Îr]¡¨³]É²õ=ÅQá¡úœ>«-–ĞÎ,ã
 öÍ!6Y¦Ğ&õû³2 B1n›æD@b¨¾9t+·‰W¯ZÓß,Š‚Om»dÕPª:äX¯œUP•«¶ÂßëÃj¨»ä•zøİ2J¼U­¸ÉZPÒ-FH¤$º•ºM‘È¡£u*ËØ©ë”JRJ&ˆÜæÀÄ´‹™¬/e´”r’âóÇû-ôŒõÌÖNäúûú´Î×Fo‚Xy¡ª·JuÙ½gCuÈí0¡`ø§a²]©;<-EÁ¡'úæ<ÎÎN8Ñy–½)I•È$³Ğ¨ÛaÓ~™¬Êl‡&«fkåI¹i–cn^˜ó©Ï í;ü õ“Ì!=?–>LQ‘·aôæH`ÉˆÌ×¬)[¶Dªß–h“Š¶:äIKºbRÕp*Ó\‰U§l
³‘ñÀ­WïÅ[Øê}ø£€¥nØ¢iJbUnÃ~ù†‰©öÄ%Ø¥£†’´údUcïĞãh[¸šb
Zïï¥²zà%VÓp0…híóÁiSë¾47ï‘WoN¸m+jk€ïÍVœi4Õ6Æ’´äB©1ß&¥EÚ˜
 Ä±öÃ 5MJ-2ÛÕz’½VFÅ˜xûù™¦ÓË<øcñ=ÃñÉœceŠ šêWº¹nrÍöÉ¥6 ğŞi´ñÇƒ‘°ä˜$Jª€lİ½Îm! øêÒÈ±Ğ–¡ñ9’Ó¹Hõ;ŞMPI­0»* Ç/¯¾•¦ı°«Ôï•Üó4A¸Ş¸’Õ¹bÚ…ñ’N*Á§Èë•È rIå™®%XcûLvùf³W–…0‘ Ï|³¦)E=«ıs…ÖæX‡¦iöÁıÉ÷ÎS,¬·€Émb@#îé˜qİ)”Cé¦gFù!\1ë’¡YwËüĞªL+u'¦L
BªÓ¿L™UJxaBàiŠ¾Øp;å€*êŒHBå8@Uõ?,*¸e”­Å;áJ“®ÄdÒQ‚¦ƒ1Èf/˜ã{+»mF5%Cz3Óù[uûtÎê¼<²ÄNÒŸVDXeº=ÔrBœwGøƒvë§'¢ŠëĞƒ—±¹K5¬LƒaCÛzûæ&@æâ=^oæH}Aé•£ÆEi½éšÜYS_&İd±“VGaOjÔ~¼òŞ‡ºRşpìaÑèVÍÈ
¹ƒˆ×.Me1‰Aı{æxÙ‰dÄo›kuÆ•a¯lVœ
â7®—úä
·¾)h`VˆÀ«r*§ÇsLUª`VºdU¿lRÑlR·—‡\?^E\ÊHöÅ-o×¸ôÄ²Zp*ß cJÕ(6Û 
ÕõÆ’ĞÛ|B´iJôÂUmwü1V›qóÈ¥aöí‚•mNÕªõğÄªÚàóJÎXRÑo|*ÒOÑ*ƒ¿\JTªk\%	{y„s9¤h6Qö™EQârüXå–B0Ü–@[–KBàİ\S›l‘Ö5ì£åãöI0áŞ[ÀDIØ›fâ0¦JÜ-)^;£¦d ÀÚ]ypxüB©¾çSÉİMRåöjxÓ¾J,dwÙŒj7›”ëüØ˜l7TÔDe ¾ÜG\¬–\ƒ¼» cYîGjer<"ÚŠiåİ<ÜÊ³0ØôöÉë³ók›{—´À‘)>>;ç«Ïe¾!™ÛZÅÎôì3G)³Mã¦[ˆTlcaòú3(b¬‘ıÙ(ÁU•)°ÌŠîBğ;}ø«t¦7Ü…ë“U^Ã$‡¾«Å×,
İpÒ®zœ *úôÉR¯jxä€Vëµ{œ*±‡ß…Pó *r²c:å‚İÛMnÛzŠV¾±úQ,°å#Î&ÿ [`)–uB"ÌxËzn¤şÒìsÙôÙ„à$9‰Gzg2ÍuŞ³f‡[([¥!ˆ$î+”ÍÈÇÉ†yƒKy’FŒ–j–Â¿Ç5¹b\èÈSòÁƒQ¹³Ó‘£°)±vy÷´šrcÃ§¤üw^­§=PîşÃ9Œf÷`SÈw»ØGpÖ_ÿÙ